<!DOCTYPE html>
<html>
<head>
  <title>ESP32 Location Simulator</title>
</head>
<body>
  <h2>ESP32 Location Simulator</h2>
  <form id="simForm">
    <label>Device IDs (comma separated):</label><br/>
    <input type="text" id="deviceIds" placeholder="e.g. dev1,dev2"><br/><br/>

    <label>Start Location:</label><br/>
    <input type="number" step="0.0001" id="startLat" placeholder="Latitude">
    <input type="number" step="0.0001" id="startLng" placeholder="Longitude"><br/><br/>

    <label>End Location:</label><br/>
    <input type="number" step="0.0001" id="endLat" placeholder="Latitude">
    <input type="number" step="0.0001" id="endLng" placeholder="Longitude"><br/><br/>

    <button type="button" onclick="startSim()">Start</button>
    <button type="button" onclick="stopSim()">Stop</button>
  </form>

  <pre id="output"></pre>

  <script>
    async function startSim() {
      const deviceIds = document.getElementById("deviceIds").value.split(",");
      const startLat = parseFloat(document.getElementById("startLat").value);
      const startLng = parseFloat(document.getElementById("startLng").value);
      const endLat = parseFloat(document.getElementById("endLat").value);
      const endLng = parseFloat(document.getElementById("endLng").value);

      const res = await fetch("/start", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          deviceIds,
          startLocation: { lat: startLat, lng: startLng },
          endLocation: { lat: endLat, lng: endLng },
        }),
      });
      document.getElementById("output").innerText = JSON.stringify(await res.json(), null, 2);
    }

    async function stopSim() {
      const deviceIds = document.getElementById("deviceIds").value.split(",");
      const res = await fetch("/stop", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ deviceIds }),
      });
      document.getElementById("output").innerText = JSON.stringify(await res.json(), null, 2);
    }
  </script>
</body>
</html>
